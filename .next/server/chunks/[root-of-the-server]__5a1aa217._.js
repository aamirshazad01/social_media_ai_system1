module.exports=[93695,(e,r,t)=>{r.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},42315,(e,r,t)=>{"use strict";r.exports=e.r(18622)},21517,(e,r,t)=>{r.exports=e.x("http",()=>require("http"))},92509,(e,r,t)=>{r.exports=e.x("url",()=>require("url"))},24836,(e,r,t)=>{r.exports=e.x("https",()=>require("https"))},32319,(e,r,t)=>{r.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},24725,(e,r,t)=>{r.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},18622,(e,r,t)=>{r.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(e,r,t)=>{r.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},70406,(e,r,t)=>{r.exports=e.x("next/dist/compiled/@opentelemetry/api",()=>require("next/dist/compiled/@opentelemetry/api"))},97953,(e,r,t)=>{"use strict";r.exports=e.r(42315).vendored["react-rsc"].ReactServerDOMTurbopackServer},32676,e=>{"use strict";var r=e.i(97953);let t=(0,r.registerClientReference)(function(){throw Error("Attempted to call createBrowserClient() from the server but createBrowserClient is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/lib/supabase/index.ts <module evaluation>","createBrowserClient"),n=(0,r.registerClientReference)(function(){throw Error("Attempted to call supabase() from the server but supabase is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/lib/supabase/index.ts <module evaluation>","supabase");e.s(["createBrowserClient",0,t,"supabase",0,n])},26222,e=>{"use strict";var r=e.i(97953);let t=(0,r.registerClientReference)(function(){throw Error("Attempted to call createBrowserClient() from the server but createBrowserClient is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/lib/supabase/index.ts","createBrowserClient"),n=(0,r.registerClientReference)(function(){throw Error("Attempted to call supabase() from the server but supabase is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/src/lib/supabase/index.ts","supabase");e.s(["createBrowserClient",0,t,"supabase",0,n])},22109,e=>{"use strict";e.i(32676);var r=e.i(26222);e.n(r)},5891,56410,e=>{"use strict";var r=e.i(22109);async function t(e,r){let t=new TextEncoder,n=await window.crypto.subtle.importKey("raw",t.encode(e),"PBKDF2",!1,["deriveBits","deriveKey"]);return window.crypto.subtle.deriveKey({name:"PBKDF2",salt:r,iterations:1e5,hash:"SHA-256"},n,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"])}async function n(e,r){try{let n=new TextEncoder,a=window.crypto.getRandomValues(new Uint8Array(16)),o=window.crypto.getRandomValues(new Uint8Array(12)),s=await t(r,a),i=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:o},s,n.encode(e)),c=new Uint8Array(a.length+o.length+i.byteLength);return c.set(a,0),c.set(o,a.length),c.set(new Uint8Array(i),a.length+o.length),btoa(String.fromCharCode(...c))}catch(e){throw console.error("Encryption error:",e),Error("Failed to encrypt data")}}async function a(e,r){try{let n=Uint8Array.from(atob(e),e=>e.charCodeAt(0)),a=n.slice(0,16),o=n.slice(16,28),s=n.slice(28),i=await t(r,a),c=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:o},i,s);return new TextDecoder().decode(c)}catch(e){throw console.error("Decryption error:",e),Error("Failed to decrypt data")}}function o(e){return`${e}_encryption_key_v1`}class s{static async savePlatformCredentials(e,t,a,s){try{let i=o(a),c=JSON.stringify(t),l=await n(c,i),{data:d}=await r.supabase.from("social_accounts").select("id").eq("workspace_id",s).eq("platform",e).maybeSingle();if(d){let e="username"in t?t.username??null:null,{error:n}=await r.supabase.from("social_accounts").update({credentials_encrypted:l,is_connected:t.isConnected,username:e,connected_at:t.isConnected?new Date().toISOString():null,last_verified_at:new Date().toISOString()}).eq("id",d.id);if(n)throw n}else{let n="username"in t?t.username??null:null,{error:a}=await r.supabase.from("social_accounts").insert({workspace_id:s,platform:e,credentials_encrypted:l,is_connected:t.isConnected,username:n,connected_at:t.isConnected?new Date().toISOString():null,last_verified_at:new Date().toISOString()});if(a)throw a}}catch(e){throw console.error("Error saving credentials:",e),e}}static async getPlatformCredentials(e,t,n){try{let{data:s,error:i}=await r.supabase.from("social_accounts").select("credentials_encrypted").eq("workspace_id",n).eq("platform",e).maybeSingle();if(i||!s)return null;let c=o(t),l=await a(s.credentials_encrypted,c);return JSON.parse(l)}catch(e){return console.error("Error getting credentials:",e),null}}static async getAllCredentials(e,t){try{let{data:n,error:s}=await r.supabase.from("social_accounts").select("platform, credentials_encrypted").eq("workspace_id",t);if(s)throw s;let i={},c=o(e);for(let e of n||[])try{let r=await a(e.credentials_encrypted,c);i[e.platform]=JSON.parse(r)}catch(r){console.error(`Error decrypting ${e.platform} credentials:`,r)}return i}catch(e){return console.error("Error getting all credentials:",e),{}}}static async isPlatformConnected(e,t){try{let{data:n,error:a}=await r.supabase.from("social_accounts").select("is_connected").eq("workspace_id",t).eq("platform",e).maybeSingle();if(a||!n)return!1;return n.is_connected}catch(e){return!1}}static async getConnectionSummary(e){try{let{data:t,error:n}=await r.supabase.from("social_accounts").select("platform, is_connected").eq("workspace_id",e);if(n)throw n;let a={twitter:!1,linkedin:!1,facebook:!1,instagram:!1};for(let e of t||[])a[e.platform]=e.is_connected;return a}catch(e){return console.error("Error getting connection summary:",e),{twitter:!1,linkedin:!1,facebook:!1,instagram:!1}}}static async disconnectPlatform(e,r,t){try{let n=await this.getPlatformCredentials(e,r,t);if(!n)return;n.isConnected=!1,await this.savePlatformCredentials(e,n,r,t)}catch(e){throw console.error("Error disconnecting platform:",e),e}}static async deletePlatformCredentials(e,t){try{let{error:n}=await r.supabase.from("social_accounts").delete().eq("workspace_id",t).eq("platform",e);if(n)throw n}catch(e){throw console.error("Error deleting credentials:",e),e}}static async clearAllCredentials(e){try{let{error:t}=await r.supabase.from("social_accounts").delete().eq("workspace_id",e);if(t)throw t}catch(e){throw console.error("Error clearing all credentials:",e),e}}}e.s(["CredentialService",()=>s],56410),e.s([],5891)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__5a1aa217._.js.map