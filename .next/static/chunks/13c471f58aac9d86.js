(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,33525,(e,s,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"warnOnce",{enumerable:!0,get:function(){return a}});let a=e=>{}},18566,(e,s,t)=>{s.exports=e.r(76562)},24189,e=>{"use strict";var s=e.i(43476),t=e.i(71645),a=e.i(18566),r=e.i(75254);let i=(0,r.default)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);var l=e.i(39616);let n=(0,r.default)("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);var o=e.i(73375),c=e.i(22016);let d=[{id:"members",label:"Members",icon:(0,s.jsx)(i,{size:20})},{id:"workspace",label:"Settings",icon:(0,s.jsx)(l.Settings,{size:20})},{id:"activity",label:"Activity Log",icon:(0,s.jsx)(n,{size:20})}];function m({children:e,activeTab:t}){return(0,s.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,s.jsx)("div",{className:"bg-white border-b border-gray-200",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto px-6 py-8",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4 mb-6",children:[(0,s.jsx)(c.default,{href:"/",className:"text-slate hover:text-charcoal transition-colors",children:(0,s.jsx)(o.ChevronLeft,{size:24})}),(0,s.jsx)("h1",{className:"text-3xl font-bold text-charcoal",children:"Workspace Settings"})]}),(0,s.jsx)("p",{className:"text-slate",children:"Manage your workspace, members, and activity"})]})}),(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-6 py-8",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8",children:[(0,s.jsx)("div",{className:"lg:col-span-1",children:(0,s.jsx)("nav",{className:"space-y-2 sticky top-8",children:d.map(e=>(0,s.jsxs)(c.default,{href:`/settings?tab=${e.id}`,className:`flex items-center gap-3 px-4 py-3 rounded-lg font-medium transition-colors ${t===e.id?"bg-blue-600 text-white":"text-slate hover:bg-gray-100"}`,children:[e.icon,e.label]},e.id))})}),(0,s.jsx)("div",{className:"lg:col-span-3",children:(0,s.jsx)("div",{className:"bg-white rounded-lg border border-gray-200 p-8",children:e})})]})})]})}var x=e.i(57951),h=e.i(67051),u=e.i(7233),p=e.i(27612);let b=(0,r.default)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);var g=e.i(21345);let y=(0,r.default)("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);var v=e.i(83627),f=e.i(86536);let j=({role:e,size:t="md",className:a=""})=>{let r={admin:{label:"Admin",color:"bg-blue-600 text-white",icon:y,description:"Full workspace control"},editor:{label:"Editor",color:"bg-green-600 text-white",icon:v.Edit3,description:"Create & edit content"},viewer:{label:"Viewer",color:"bg-slate text-white",icon:f.Eye,description:"Read-only access"}}[e],i=r.icon;return(0,s.jsxs)("span",{className:`inline-flex items-center gap-1.5 rounded-full font-semibold ${r.color} ${{sm:"text-xs px-2 py-0.5",md:"text-sm px-2.5 py-1",lg:"text-base px-3 py-1.5"}[t]} ${a}`,title:r.description,children:[(0,s.jsx)(i,{className:{sm:"w-3 h-3",md:"w-4 h-4",lg:"w-5 h-5"}[t]}),(0,s.jsx)("span",{children:r.label})]})},k=(0,r.default)("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]),w=(0,r.default)("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]);var N=e.i(31278),C=e.i(5766);let _=({member:e,currentUserRole:a,currentUserId:r,onRoleChange:i,onRemove:l})=>{let[n,o]=(0,t.useState)(!1),[c,d]=(0,t.useState)(!1),[m,x]=(0,t.useState)(e.role),[h,u]=(0,t.useState)(!1),b=e.id===r,g=async s=>{if(s===e.role)return void d(!1);u(!0),x(s);try{await i(e.id,s),C.default.success(`Role updated to ${s}`),d(!1)}catch(s){C.default.error("Failed to update role"),x(e.role)}finally{u(!1)}},y=async()=>{if(confirm(`Are you sure you want to remove ${e.full_name||e.email} from the workspace? This action cannot be undone.`)){u(!0);try{await l(e.id),C.default.success("Member removed successfully"),o(!1)}catch(e){C.default.error("Failed to remove member")}finally{u(!1)}}};return(0,s.jsxs)("div",{className:"bg-white border border-slate/30 rounded-lg p-4 flex items-center gap-4 hover:shadow-md transition-shadow",children:[(0,s.jsx)("div",{className:"flex-shrink-0",children:e.avatar_url?(0,s.jsx)("img",{src:e.avatar_url,alt:e.full_name||e.email,className:"w-12 h-12 rounded-full object-cover border-2 border-slate/20"}):(0,s.jsx)("div",{className:"w-12 h-12 rounded-full bg-charcoal text-white flex items-center justify-center text-lg font-bold",children:(e.full_name||e.email).charAt(0).toUpperCase()})}),(0,s.jsxs)("div",{className:"flex-grow min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("h3",{className:"font-semibold text-charcoal-dark truncate",children:e.full_name||"No name"}),b&&(0,s.jsx)("span",{className:"text-xs text-slate bg-slate/10 px-2 py-0.5 rounded",children:"You"})]}),(0,s.jsx)("p",{className:"text-sm text-slate truncate",children:e.email}),(0,s.jsxs)("p",{className:"text-xs text-slate mt-1",children:["Joined ",new Date(e.created_at).toLocaleDateString()]})]}),(0,s.jsx)("div",{className:"flex-shrink-0",children:c&&!h?(0,s.jsxs)("select",{value:m,onChange:e=>g(e.target.value),onBlur:()=>{d(!1),x(e.role)},autoFocus:!0,className:"border border-slate/30 rounded-md px-2 py-1 text-sm focus:ring-2 focus:ring-charcoal focus:border-charcoal",children:[(0,s.jsx)("option",{value:"admin",children:"Admin"}),(0,s.jsx)("option",{value:"editor",children:"Editor"}),(0,s.jsx)("option",{value:"viewer",children:"Viewer"})]}):(0,s.jsx)(j,{role:e.role})}),"admin"===a&&!b&&(0,s.jsxs)("div",{className:"flex-shrink-0 relative",children:[(0,s.jsx)("button",{onClick:()=>o(!n),disabled:h,className:"p-2 rounded-full hover:bg-slate/10 transition-colors disabled:opacity-50","aria-label":"Member actions",children:(0,s.jsx)(k,{className:"w-5 h-5 text-slate"})}),n&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"fixed inset-0 z-10",onClick:()=>o(!1)}),(0,s.jsxs)("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-xl border border-slate/30 py-1 z-20",children:[(0,s.jsxs)("button",{onClick:()=>{d(!0),o(!1)},disabled:h,className:"w-full px-4 py-2 text-left text-sm hover:bg-slate/10 flex items-center gap-2 text-charcoal-dark disabled:opacity-50",children:[(0,s.jsx)(w,{className:"w-4 h-4"}),"Change Role"]}),(0,s.jsx)("button",{onClick:y,disabled:h,className:"w-full px-4 py-2 text-left text-sm hover:bg-red-50 flex items-center gap-2 text-red-600 disabled:opacity-50",children:h?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(N.Loader2,{className:"w-4 h-4 animate-spin"}),"Removing..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(p.Trash2,{className:"w-4 h-4"}),"Remove Member"]})})]})]})]})]})};var S=e.i(37727);let E=(0,r.default)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);var M=e.i(43531);let F=({selectedRole:e,onRoleChange:t})=>(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-charcoal-dark mb-2",children:["Role ",(0,s.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,s.jsx)("div",{className:"grid grid-cols-3 gap-3",children:["admin","editor","viewer"].map(a=>(0,s.jsxs)("button",{type:"button",onClick:()=>t(a),className:`p-3 border-2 rounded-lg transition-all ${e===a?"border-charcoal bg-charcoal/5":"border-slate/30 hover:border-slate/50"}`,children:[(0,s.jsx)(j,{role:a,size:"sm"}),(0,s.jsxs)("p",{className:"text-xs text-slate mt-2 text-center",children:["admin"===a&&"Full control","editor"===a&&"Create & edit","viewer"===a&&"View only"]})]},a))})]}),L=({expiresInDays:e,onExpirationChange:t})=>(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-charcoal-dark mb-2",children:"Link Expiration"}),(0,s.jsxs)("select",{value:e?.toString()||"never",onChange:e=>t("never"===e.target.value?null:parseInt(e.target.value)),className:"w-full px-4 py-2 border border-slate/30 rounded-lg focus:ring-2 focus:ring-charcoal focus:border-charcoal",children:[(0,s.jsx)("option",{value:"1",children:"24 hours"}),(0,s.jsx)("option",{value:"7",children:"7 days"}),(0,s.jsx)("option",{value:"30",children:"30 days"}),(0,s.jsx)("option",{value:"never",children:"Never expires"})]})]}),$=({link:e,onCopy:t,copied:a})=>(0,s.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-green-800 mb-2",children:"Invitation link generated:"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("input",{type:"text",value:e,readOnly:!0,className:"flex-1 px-3 py-2 bg-white border border-green-300 rounded text-sm font-mono text-slate"}),(0,s.jsx)("button",{type:"button",onClick:t,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center gap-2",children:a?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(M.Check,{className:"w-4 h-4"}),"Copied"]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(E,{className:"w-4 h-4"}),"Copy"]})})]})]}),z=({isOpen:e,onClose:a,onInviteCreated:r})=>{let[i,l]=(0,t.useState)(""),[n,o]=(0,t.useState)("editor"),[c,d]=(0,t.useState)(7),[m,x]=(0,t.useState)(!1),[h,u]=(0,t.useState)(null),[p,y]=(0,t.useState)(!1),[v,f]=(0,t.useState)("email"),j=()=>{l(""),o("editor"),d(7),u(null),y(!1),f("email"),x(!1),a()},k=async e=>{if(e.preventDefault(),!i.trim())return void C.default.error("Please enter an email address");if(!i.includes("@"))return void C.default.error("Please enter a valid email address");x(!0);try{let e=await fetch("/api/workspace/invites",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:i,role:n,expiresInDays:c||void 0})});if(!e.ok){let s=await e.json();throw Error(s.error||"Failed to send invitation")}let{data:s}=await e.json();C.default.success(`Invitation sent to ${i}`),u(s.inviteUrl),r(),l("")}catch(e){console.error("Error sending invitation:",e),C.default.error(e instanceof Error?e.message:"Failed to send invitation")}finally{x(!1)}},w=async()=>{x(!0);try{let e=await fetch("/api/workspace/invites",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({role:n,expiresInDays:c||void 0})});if(!e.ok){let s=await e.json();throw Error(s.error||"Failed to generate link")}let{data:s}=await e.json();u(s.inviteUrl),C.default.success("Invite link generated"),r()}catch(e){console.error("Error generating link:",e),C.default.error(e instanceof Error?e.message:"Failed to generate link")}finally{x(!1)}},_=async()=>{if(h)try{await navigator.clipboard.writeText(h),y(!0),C.default.success("Link copied to clipboard"),setTimeout(()=>y(!1),2e3)}catch(e){C.default.error("Failed to copy link")}};return e?(0,s.jsx)("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4",onClick:j,children:(0,s.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] flex flex-col border border-slate/30 overflow-hidden",onClick:e=>e.stopPropagation(),children:[(0,s.jsxs)("header",{className:"flex justify-between items-center p-6 border-b border-slate/30",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-charcoal-dark",children:"Invite Team Members"}),(0,s.jsx)("button",{onClick:j,className:"p-2 rounded-full text-slate hover:bg-slate/10 hover:text-charcoal-dark transition-colors","aria-label":"Close modal",children:(0,s.jsx)(S.X,{className:"w-6 h-6"})})]}),(0,s.jsxs)("div",{className:"flex border-b border-slate/30",children:[(0,s.jsxs)("button",{onClick:()=>f("email"),className:`flex-1 px-6 py-3 font-medium transition-colors flex items-center justify-center gap-2 ${"email"===v?"text-charcoal-dark border-b-2 border-charcoal":"text-slate hover:text-charcoal-dark"}`,children:[(0,s.jsx)(b,{className:"w-5 h-5"}),"Email Invitation"]}),(0,s.jsxs)("button",{onClick:()=>f("link"),className:`flex-1 px-6 py-3 font-medium transition-colors flex items-center justify-center gap-2 ${"link"===v?"text-charcoal-dark border-b-2 border-charcoal":"text-slate hover:text-charcoal-dark"}`,children:[(0,s.jsx)(g.Link,{className:"w-5 h-5"}),"Shareable Link"]})]}),(0,s.jsx)("div",{className:"flex-1 overflow-y-auto p-6",children:"email"===v?(0,s.jsxs)("form",{onSubmit:k,className:"space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-charcoal-dark mb-2",children:["Email Address ",(0,s.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,s.jsx)("input",{type:"email",value:i,onChange:e=>l(e.target.value),placeholder:"colleague@example.com",className:"w-full px-4 py-2 border border-slate/30 rounded-lg focus:ring-2 focus:ring-charcoal focus:border-charcoal",disabled:m,required:!0}),(0,s.jsx)("p",{className:"text-xs text-slate mt-1",children:"An invitation email will be sent to this address with a secure link"})]}),(0,s.jsx)(F,{selectedRole:n,onRoleChange:o}),(0,s.jsx)(L,{expiresInDays:c,onExpirationChange:d}),h&&(0,s.jsx)($,{link:h,onCopy:_,copied:p}),(0,s.jsx)("button",{type:"submit",disabled:m,className:"w-full px-4 py-3 bg-charcoal text-white rounded-lg hover:bg-charcoal-dark transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:m?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(N.Loader2,{className:"w-5 h-5 animate-spin"}),"Sending..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(b,{className:"w-5 h-5"}),"Send Invitation"]})})]}):(0,s.jsx)(T,{role:n,onRoleChange:o,expiresInDays:c,onExpirationChange:d,generatedLink:h,isSubmitting:m,onGenerateLink:w,linkCopied:p,onCopyLink:_})})]})}):null},T=({role:e,onRoleChange:t,expiresInDays:a,onExpirationChange:r,generatedLink:i,isSubmitting:l,onGenerateLink:n,linkCopied:o,onCopyLink:c})=>(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,s.jsx)("p",{className:"text-sm text-blue-800",children:"Generate a shareable link that anyone can use to join your workspace. No email required!"})}),(0,s.jsx)(F,{selectedRole:e,onRoleChange:t}),(0,s.jsx)(L,{expiresInDays:a,onExpirationChange:r}),i?(0,s.jsx)($,{link:i,onCopy:c,copied:o}):(0,s.jsx)("button",{onClick:n,disabled:l,className:"w-full px-4 py-3 bg-charcoal text-white rounded-lg hover:bg-charcoal-dark transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:l?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(N.Loader2,{className:"w-5 h-5 animate-spin"}),"Generating..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(g.Link,{className:"w-5 h-5"}),"Generate Invite Link"]})})]});function I(){let{user:e,workspaceId:a,userRole:r}=(0,x.useAuth)(),{addNotification:i}=(0,h.useNotifications)(),[l,n]=(0,t.useState)([]),[o,c]=(0,t.useState)([]),[d,m]=(0,t.useState)(!0),[y,v]=(0,t.useState)(!1),f="admin"===r;(0,t.useEffect)(()=>{a&&(async()=>{try{m(!0);let e=await fetch("/api/workspace/members");if(e.ok){let{data:s}=await e.json();n(s)}if(f){let e=await fetch("/api/workspace/invites");if(e.ok){let{data:s}=await e.json();c(s)}}}catch(e){console.error("Error loading workspace data:",e),i("error","Load Failed","Failed to load workspace members")}finally{m(!1)}})()},[a,f,i]);let k=async e=>{if(a&&confirm("Are you sure you want to remove this member?"))try{(await fetch(`/api/workspace/members/${e}`,{method:"DELETE"})).ok?(n(l.filter(s=>s.id!==e)),i("post_published","Success","Member removed successfully")):i("error","Failed","Failed to remove member")}catch(e){console.error("Error removing member:",e),i("error","Error","Error removing member")}},w=async(e,s)=>{if(a)try{(await fetch(`/api/workspace/members/${e}/role`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({role:s})})).ok?(n(l.map(t=>t.id===e?{...t,role:s}:t)),i("post_published","Member role updated","Member role updated")):i("error","Failed to update member role","Failed to update member role")}catch(e){console.error("Error updating role:",e),i("error","Error updating member role","Error updating member role")}},N=async e=>{if(a&&confirm("Are you sure you want to revoke this invitation?"))try{(await fetch("/api/workspace/invites",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({inviteId:e})})).ok?(c(o.filter(s=>s.id!==e)),i("post_published","Invitation revoked","Invitation revoked")):i("error","Failed to revoke invitation","Failed to revoke invitation")}catch(e){console.error("Error revoking invite:",e),i("error","Error revoking invitation","Error revoking invitation")}},C=async e=>{if(a)try{(await fetch("/api/workspace/invites",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"resend",inviteId:e})})).ok?i("post_published","Invitation resent successfully","Invitation resent successfully"):i("error","Failed to resend invitation","Failed to resend invitation")}catch(e){console.error("Error resending invite:",e),i("error","Error resending invitation","Error resending invitation")}},S=async()=>{if(v(!1),f)try{let e=await fetch("/api/workspace/invites");if(e.ok){let{data:s}=await e.json();c(s)}}catch(e){console.error("Error refreshing invites:",e)}};return d?(0,s.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,s.jsx)("div",{className:"text-slate",children:"Loading members..."})}):(0,s.jsxs)("div",{className:"space-y-8",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-charcoal",children:"Workspace Members"}),(0,s.jsxs)("p",{className:"text-sm text-slate mt-1",children:[l.length," member",1!==l.length?"s":""]})]}),f&&(0,s.jsxs)("button",{onClick:()=>v(!0),className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[(0,s.jsx)(u.Plus,{size:18}),"Invite Member"]})]}),(0,s.jsx)("div",{className:"space-y-3",children:0===l.length?(0,s.jsx)("div",{className:"text-center py-8 bg-gray-50 rounded-lg",children:(0,s.jsx)("p",{className:"text-slate",children:"No members yet"})}):l.map(t=>(0,s.jsx)(_,{member:t,currentUserRole:r||"viewer",currentUserId:e?.id||"",onRemove:async e=>k(e),onRoleChange:async(e,s)=>w(e,s)},t.id))})]}),f&&o.length>0&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-charcoal mb-6",children:"Pending Invitations"}),(0,s.jsx)("div",{className:"space-y-3",children:o.map(e=>(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg border border-gray-200",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4 flex-1",children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-full bg-blue-100 flex items-center justify-center",children:e.email?(0,s.jsx)(b,{size:20,className:"text-blue-600"}):(0,s.jsx)(g.Link,{size:20,className:"text-blue-600"})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"font-medium text-charcoal",children:e.email||"Shareable Link"}),(0,s.jsx)("p",{className:"text-sm text-slate",children:e.email?"Email invitation":"Anyone with link can join"})]}),(0,s.jsx)(j,{role:e.role,size:"sm"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[e.expires_at&&new Date(e.expires_at)<new Date&&(0,s.jsx)("span",{className:"text-xs px-2 py-1 bg-red-100 text-red-700 rounded",children:"Expired"}),(0,s.jsx)("button",{onClick:()=>C(e.id),className:"p-2 hover:bg-white rounded transition-colors",title:"Resend invitation",children:(0,s.jsx)(b,{size:18,className:"text-blue-600"})}),(0,s.jsx)("button",{onClick:()=>N(e.id),className:"p-2 hover:bg-white rounded transition-colors",title:"Revoke invitation",children:(0,s.jsx)(p.Trash2,{size:18,className:"text-red-600"})})]})]},e.id))})]}),(0,s.jsx)(z,{isOpen:y,onClose:()=>v(!1),onInviteCreated:S})]})}var R=e.i(56909),A=e.i(63209);function D(){let{workspaceId:e,userRole:a}=(0,x.useAuth)(),{addNotification:r}=(0,h.useNotifications)(),[i,l]=(0,t.useState)(null),[n,o]=(0,t.useState)(!0),[c,d]=(0,t.useState)(!1),[m,u]=(0,t.useState)({name:"",max_users:10}),p="admin"===a;(0,t.useEffect)(()=>{e&&(async()=>{try{o(!0);let e=await fetch("/api/workspace");if(e.ok){let{data:s}=await e.json();l(s),u({name:s.name||"",max_users:s.max_users||10})}}catch(e){console.error("Error loading workspace:",e),r("error","Failed to load workspace settings","Failed to load workspace settings")}finally{o(!1)}})()},[e,r]);let b=e=>{let{name:s,value:t}=e.target;u(e=>({...e,[s]:"max_users"===s?parseInt(t,10):t}))},g=async()=>{if(e){if(!m.name.trim())return void r("error","Workspace name cannot be empty","Workspace name cannot be empty");if(m.max_users<1)return void r("error","Maximum users must be at least 1","Maximum users must be at least 1");try{d(!0);let e=await fetch("/api/workspace",{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(m)});if(e.ok){let{data:s}=await e.json();l(s),r("post_published","Workspace settings updated successfully","Workspace settings updated successfully")}else r("error","Failed to update workspace settings","Failed to update workspace settings")}catch(e){console.error("Error saving workspace:",e),r("error","Error updating workspace settings","Error updating workspace settings")}finally{d(!1)}}};return n?(0,s.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,s.jsx)("div",{className:"text-slate",children:"Loading workspace settings..."})}):p?(0,s.jsxs)("div",{className:"max-w-2xl space-y-8",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"name",className:"block text-sm font-medium text-charcoal mb-2",children:"Workspace Name"}),(0,s.jsx)("input",{id:"name",name:"name",type:"text",value:m.name,onChange:b,placeholder:"My Workspace",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,s.jsx)("p",{className:"text-xs text-slate mt-1",children:"The name of your workspace"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{htmlFor:"max_users",className:"block text-sm font-medium text-charcoal mb-2",children:"Maximum Members"}),(0,s.jsx)("input",{id:"max_users",name:"max_users",type:"number",min:"1",max:"1000",value:m.max_users,onChange:b,className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),(0,s.jsx)("p",{className:"text-xs text-slate mt-1",children:"Maximum number of members allowed in this workspace"})]}),i&&(0,s.jsxs)("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:[(0,s.jsx)("h3",{className:"font-semibold text-blue-900 mb-3",children:"Workspace Information"}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-blue-700 font-medium",children:"Created"}),(0,s.jsx)("p",{className:"text-blue-600",children:new Date(i.created_at).toLocaleDateString()})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-blue-700 font-medium",children:"Last Updated"}),(0,s.jsx)("p",{className:"text-blue-600",children:new Date(i.updated_at).toLocaleDateString()})]})]})]}),(0,s.jsxs)("button",{onClick:g,disabled:c||!p,className:"flex items-center gap-2 px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors",children:[(0,s.jsx)(R.Save,{size:18}),c?"Saving...":"Save Changes"]})]}):(0,s.jsxs)("div",{className:"p-6 bg-yellow-50 border border-yellow-200 rounded-lg flex items-gap-3",children:[(0,s.jsx)(A.AlertCircle,{className:"text-yellow-600 flex-shrink-0",size:20}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-semibold text-yellow-900",children:"Access Denied"}),(0,s.jsx)("p",{className:"text-sm text-yellow-800",children:"Only workspace admins can modify workspace settings."})]})]})}let O=(0,r.default)("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),P=(0,r.default)("UserMinus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),U=(0,r.default)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),W={member_invited:(0,s.jsx)(O,{size:16,className:"text-blue-600"}),member_joined:(0,s.jsx)(O,{size:16,className:"text-green-600"}),member_removed:(0,s.jsx)(P,{size:16,className:"text-red-600"}),member_role_changed:(0,s.jsx)(y,{size:16,className:"text-orange-600"}),workspace_updated:(0,s.jsx)(l.Settings,{size:16,className:"text-purple-600"}),invite_revoked:(0,s.jsx)(p.Trash2,{size:16,className:"text-red-600"})},J={member_invited:"Member Invited",member_joined:"Member Joined",member_removed:"Member Removed",member_role_changed:"Role Changed",workspace_updated:"Workspace Updated",invite_revoked:"Invite Revoked"};function q(){let{workspaceId:e,userRole:a}=(0,x.useAuth)(),{addNotification:r}=(0,h.useNotifications)(),[i,l]=(0,t.useState)([]),[n,o]=(0,t.useState)(!0),[c,d]=(0,t.useState)(0),[m,u]=(0,t.useState)(!1),p="admin"===a;return((0,t.useEffect)(()=>{e&&p&&(async()=>{try{o(!0);let e=await fetch(`/api/workspace/activity?limit=20&offset=${20*c}`);if(e.ok){let s=await e.json();l(s.data),u(s.hasMore)}}catch(e){console.error("Error loading activity log:",e),r("error","Load Failed","Failed to load activity log")}finally{o(!1)}})()},[e,p,c,r]),p)?n&&0===i.length?(0,s.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,s.jsx)("div",{className:"text-slate",children:"Loading activity log..."})}):(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("div",{className:"flex justify-end",children:(0,s.jsxs)("button",{onClick:()=>{d(0)},className:"flex items-center gap-2 px-4 py-2 text-slate hover:bg-gray-100 rounded-lg transition-colors",children:[(0,s.jsx)(U,{size:16}),"Refresh"]})}),0===i.length?(0,s.jsx)("div",{className:"text-center py-12 bg-gray-50 rounded-lg",children:(0,s.jsx)("p",{className:"text-slate",children:"No activity yet"})}):(0,s.jsx)("div",{className:"space-y-2",children:i.map(e=>(0,s.jsxs)("div",{className:"flex items-start gap-4 p-4 bg-gray-50 rounded-lg border border-gray-200 hover:bg-gray-100 transition-colors",children:[(0,s.jsx)("div",{className:"pt-1",children:W[e.action]||(0,s.jsx)(U,{size:16,className:"text-slate"})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsx)("div",{className:"flex items-center gap-2 mb-1",children:(0,s.jsx)("p",{className:"font-medium text-charcoal",children:J[e.action]||e.action})}),(0,s.jsx)("p",{className:"text-sm text-slate",children:(e=>{let{action:s,details:t,user:a}=e,r=a?.full_name||a?.email||"Unknown";switch(s){case"member_invited":return`${r} invited ${t.invite_email||"someone"} as ${t.invite_role}`;case"member_joined":return`${r} joined as ${t.role}`;case"member_removed":return`${r} removed ${t.removed_user_email}`;case"member_role_changed":return`${r} changed ${t.target_user_email}'s role from ${t.old_role} to ${t.new_role}`;case"workspace_updated":return`${r} updated workspace settings`;case"invite_revoked":return`${r} revoked an invitation for ${t.invite_email||"shareable link"}`;default:return`${r} performed action: ${s}`}})(e)}),Object.keys(e.details).length>0&&(0,s.jsxs)("details",{className:"mt-2",children:[(0,s.jsx)("summary",{className:"text-xs text-slate cursor-pointer hover:text-charcoal",children:"Details"}),(0,s.jsx)("pre",{className:"mt-2 p-2 bg-white rounded text-xs overflow-auto",children:JSON.stringify(e.details,null,2)})]})]}),(0,s.jsx)("div",{className:"text-right flex-shrink-0",children:(0,s.jsx)("p",{className:"text-xs text-slate whitespace-nowrap",children:new Date(e.created_at).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"})})})]},e.id))}),m||c>0&&(0,s.jsxs)("div",{className:"flex items-center justify-between mt-6 pt-4 border-t border-gray-200",children:[(0,s.jsx)("button",{onClick:()=>d(e=>Math.max(0,e-1)),disabled:0===c,className:"px-4 py-2 text-slate hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg transition-colors",children:"Previous"}),(0,s.jsxs)("span",{className:"text-sm text-slate",children:["Page ",c+1]}),(0,s.jsx)("button",{onClick:()=>d(e=>e+1),disabled:!m,className:"px-4 py-2 text-slate hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed rounded-lg transition-colors",children:"Next"})]})]}):(0,s.jsxs)("div",{className:"p-6 bg-yellow-50 border border-yellow-200 rounded-lg",children:[(0,s.jsx)("h3",{className:"font-semibold text-yellow-900",children:"Access Restricted"}),(0,s.jsx)("p",{className:"text-sm text-yellow-800",children:"Activity logs are only available to workspace admins."})]})}function H(){let e=(0,a.useSearchParams)().get("tab")||"members",r=(0,t.useMemo)(()=>{switch(e){case"members":default:return(0,s.jsx)(I,{});case"workspace":return(0,s.jsx)(D,{});case"activity":return(0,s.jsx)(q,{})}},[e]);return(0,s.jsx)(m,{activeTab:e,children:r})}e.s(["default",()=>H],24189)}]);