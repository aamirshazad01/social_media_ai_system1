{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/aamir/social_media_os/src/lib/supabase/client.ts"],"sourcesContent":["/**\r\n * Supabase Browser Client\r\n * Use this client in client-side components (components with \"use client\")\r\n */\r\n\r\nimport { createBrowserClient } from '@supabase/ssr'\r\nimport type { Database } from './types'\r\n\r\nexport function createClient() {\r\n  return createBrowserClient<Database>(\r\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!\r\n  )\r\n}\r\n\r\n// Singleton instance for convenience\r\nexport const supabase = createClient()\r\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;;;AAOG;AALJ;AAAA;;AAGO,SAAS;IACd,OAAO,IAAA,oMAAmB;AAI5B;AAGO,MAAM,WAAW","debugId":null}},
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/aamir/social_media_os/src/lib/supabase/index.ts"],"sourcesContent":["/**\n * Supabase Client Exports (Client-only)\n * Import from here only in client components/services.\n * Server utilities should import from `@/lib/supabase/server` directly.\n */\n\"use client\"\n\nexport { createClient as createBrowserClient, supabase } from './client'\nexport type { Database } from './types'\n"],"names":[],"mappings":"AAAA;;;;CAIC;AAGD;AAFA","debugId":null}},
    {"offset": {"line": 43, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/aamir/social_media_os/src/contexts/AuthContext.tsx"],"sourcesContent":["'use client'\r\n\r\nimport React, { createContext, useContext, useEffect, useState } from 'react'\r\nimport { User, Session } from '@supabase/supabase-js'\r\nimport { supabase } from '@/lib/supabase'\r\nimport { useRouter } from 'next/navigation'\r\n\r\ninterface AuthContextType {\r\n  user: User | null\r\n  session: Session | null\r\n  loading: boolean\r\n  workspaceId: string | null\r\n  userRole: 'admin' | 'editor' | 'viewer' | null\r\n  signUp: (email: string, password: string, fullName: string) => Promise<{ error: Error | null }>\r\n  signIn: (email: string, password: string) => Promise<{ error: Error | null }>\r\n  signOut: () => Promise<void>\r\n  refreshSession: () => Promise<void>\r\n}\r\n\r\nconst AuthContext = createContext<AuthContextType | undefined>(undefined)\r\n\r\nexport function AuthProvider({ children }: { children: React.ReactNode }) {\r\n  const [user, setUser] = useState<User | null>(null)\r\n  const [session, setSession] = useState<Session | null>(null)\r\n  const [loading, setLoading] = useState(true)\r\n  const [workspaceId, setWorkspaceId] = useState<string | null>(null)\r\n  const [userRole, setUserRole] = useState<'admin' | 'editor' | 'viewer' | null>(null)\r\n\r\n  // Fetch user profile data (workspace_id and role)\r\n  const fetchUserProfile = async (userId: string) => {\n  try {\n    // Try RPC first to avoid users RLS recursion\n    const { data: rpcData, error: rpcError } = await supabase.rpc('get_my_profile')\n    if (!rpcError && rpcData) {\n      const d: any = Array.isArray(rpcData) ? rpcData[0] : rpcData\n      if (d) {\n        setWorkspaceId(d.workspace_id as string)\n        setUserRole(d.role as 'admin' | 'editor' | 'viewer')\n        return\n      }\n    }\n\n    // Fallback: direct select (requires non-recursive users RLS policy)\n    const { data, error } = await supabase\n      .from('users')\n      .select('workspace_id, role')\n      .eq('id', userId)\n      .maybeSingle()\n\n    if (error) throw error\n\n    if (!data) {\n      setWorkspaceId(null)\n      setUserRole(null)\n      return\n    }\n\n    setWorkspaceId((data as any).workspace_id as string)\n    setUserRole((data as any).role as 'admin' | 'editor' | 'viewer')\n  } catch (error) {\n    const e = error as any\n    console.error(\n      'Error fetching user profile:',\n      (e && (e.message || e.code || e.status || e.details)) ?? (typeof e === 'string' ? e : JSON.stringify(e))\n    )\n    setWorkspaceId(null)\n    setUserRole(null)\n  }\n}\n// Initialize session\r\n  useEffect(() => {\r\n    const initializeAuth = async () => {\r\n      try {\r\n        // Get initial session\r\n        const { data: { session: initialSession } } = await supabase.auth.getSession()\r\n\r\n        setSession(initialSession)\r\n        setUser(initialSession?.user ?? null)\r\n\r\n        if (initialSession?.user) {\r\n          await fetchUserProfile(initialSession.user.id)\r\n        }\r\n      } catch (error) {\r\n        console.error('Error initializing auth:', error)\r\n      } finally {\r\n        setLoading(false)\r\n      }\r\n    }\r\n\r\n    initializeAuth()\r\n\r\n    // Listen for auth changes\r\n    const { data: { subscription } } = supabase.auth.onAuthStateChange(async (event, currentSession) => {\r\n      console.log('Auth state changed:', event)\r\n\r\n      setSession(currentSession)\r\n      setUser(currentSession?.user ?? null)\r\n\r\n      if (currentSession?.user) {\r\n        await fetchUserProfile(currentSession.user.id)\r\n      } else {\r\n        setWorkspaceId(null)\r\n        setUserRole(null)\r\n      }\r\n\r\n      setLoading(false)\r\n    })\r\n\r\n    return () => {\r\n      subscription.unsubscribe()\r\n    }\r\n  }, [])\r\n\r\n  // Sign up new user\r\n  const signUp = async (email: string, password: string, fullName: string) => {\r\n    try {\r\n      const { data, error } = await supabase.auth.signUp({\r\n        email,\r\n        password,\r\n        options: {\r\n          data: {\r\n            full_name: fullName,\r\n          },\r\n        },\r\n      })\r\n\r\n      if (error) throw error\r\n\r\n      // The trigger function will automatically create workspace and user profile\r\n      return { error: null }\r\n    } catch (error) {\r\n      console.error('Sign up error:', error)\r\n      return { error: error as Error }\r\n    }\r\n  }\r\n\r\n  // Sign in existing user\r\n  const signIn = async (email: string, password: string) => {\r\n    try {\r\n      const { data, error } = await supabase.auth.signInWithPassword({\r\n        email,\r\n        password,\r\n      })\r\n\r\n      if (error) throw error\r\n\r\n      return { error: null }\r\n    } catch (error) {\r\n      console.error('Sign in error:', error)\r\n      return { error: error as Error }\r\n    }\r\n  }\r\n\r\n  // Sign out\r\n  const signOut = async () => {\r\n    try {\r\n      await supabase.auth.signOut()\r\n      setWorkspaceId(null)\r\n      setUserRole(null)\r\n    } catch (error) {\r\n      console.error('Sign out error:', error)\r\n    }\r\n  }\r\n\r\n  // Refresh session\r\n  const refreshSession = async () => {\r\n    try {\r\n      const { data: { session: refreshedSession } } = await supabase.auth.getSession()\r\n      setSession(refreshedSession)\r\n      setUser(refreshedSession?.user ?? null)\r\n\r\n      if (refreshedSession?.user) {\r\n        await fetchUserProfile(refreshedSession.user.id)\r\n      }\r\n    } catch (error) {\r\n      console.error('Error refreshing session:', error)\r\n    }\r\n  }\r\n\r\n  const value = {\r\n    user,\r\n    session,\r\n    loading,\r\n    workspaceId,\r\n    userRole,\r\n    signUp,\r\n    signIn,\r\n    signOut,\r\n    refreshSession,\r\n  }\r\n\r\n  return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>\r\n}\r\n\r\nexport function useAuth() {\r\n  const context = useContext(AuthContext)\r\n  if (context === undefined) {\r\n    throw new Error('useAuth must be used within an AuthProvider')\r\n  }\r\n  return context\r\n}\r\n\r\n"],"names":[],"mappings":"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","debugId":null}}]
}