{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 82, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/aamir/social_media_os/src/lib/supabase/server.ts"],"sourcesContent":["/**\r\n * Supabase Server Client\r\n * Use this client in server components, API routes, and server actions\r\n */\r\n\r\nimport { createServerClient, type CookieOptions } from '@supabase/ssr'\r\nimport { cookies } from 'next/headers'\r\nimport type { Database } from './types'\r\n\r\nexport async function createClient() {\n  const cookieStore = await cookies()\n\r\n  return createServerClient<Database>(\r\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,\r\n    {\r\n      cookies: {\r\n        get(name: string) {\r\n          return cookieStore.get(name)?.value\r\n        },\r\n        set(name: string, value: string, options: CookieOptions) {\r\n          try {\r\n            cookieStore.set({ name, value, ...options })\r\n          } catch (error) {\r\n            // Handle cookie errors (happens in Server Components)\r\n          }\r\n        },\r\n        remove(name: string, options: CookieOptions) {\r\n          try {\r\n            cookieStore.set({ name, value: '', ...options })\r\n          } catch (error) {\r\n            // Handle cookie errors\r\n          }\r\n        },\r\n      },\r\n    }\r\n  )\n}\n\n// Alias to match existing imports in API routes\nexport { createClient as createServerClient }\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;;;AAED;AAAA;AACA;;;AAGO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,4IAAO;IAEjC,OAAO,IAAA,iMAAkB,sUAGvB;QACE,SAAS;YACP,KAAI,IAAY;gBACd,OAAO,YAAY,GAAG,CAAC,OAAO;YAChC;YACA,KAAI,IAAY,EAAE,KAAa,EAAE,OAAsB;gBACrD,IAAI;oBACF,YAAY,GAAG,CAAC;wBAAE;wBAAM;wBAAO,GAAG,OAAO;oBAAC;gBAC5C,EAAE,OAAO,OAAO;gBACd,sDAAsD;gBACxD;YACF;YACA,QAAO,IAAY,EAAE,OAAsB;gBACzC,IAAI;oBACF,YAAY,GAAG,CAAC;wBAAE;wBAAM,OAAO;wBAAI,GAAG,OAAO;oBAAC;gBAChD,EAAE,OAAO,OAAO;gBACd,uBAAuB;gBACzB;YACF;QACF;IACF;AAEJ","debugId":null}},
    {"offset": {"line": 133, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/aamir/social_media_os/src/lib/supabase/index.ts/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const createBrowserClient = registerClientReference(\n    function() { throw new Error(\"Attempted to call createBrowserClient() from the server but createBrowserClient is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/lib/supabase/index.ts <module evaluation>\",\n    \"createBrowserClient\",\n);\nexport const supabase = registerClientReference(\n    function() { throw new Error(\"Attempted to call supabase() from the server but supabase is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/lib/supabase/index.ts <module evaluation>\",\n    \"supabase\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;;;AACvE;;AACO,MAAM,sBAAsB,IAAA,0QAAuB,EACtD;IAAa,MAAM,IAAI,MAAM;AAAsP,GACnR,2DACA;AAEG,MAAM,WAAW,IAAA,0QAAuB,EAC3C;IAAa,MAAM,IAAI,MAAM;AAAgO,GAC7P,2DACA","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 152, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/aamir/social_media_os/src/lib/supabase/index.ts/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const createBrowserClient = registerClientReference(\n    function() { throw new Error(\"Attempted to call createBrowserClient() from the server but createBrowserClient is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/lib/supabase/index.ts\",\n    \"createBrowserClient\",\n);\nexport const supabase = registerClientReference(\n    function() { throw new Error(\"Attempted to call supabase() from the server but supabase is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/lib/supabase/index.ts\",\n    \"supabase\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;;;AACvE;;AACO,MAAM,sBAAsB,IAAA,0QAAuB,EACtD;IAAa,MAAM,IAAI,MAAM;AAAsP,GACnR,uCACA;AAEG,MAAM,WAAW,IAAA,0QAAuB,EAC3C;IAAa,MAAM,IAAI,MAAM;AAAgO,GAC7P,uCACA","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 171, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 185, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/aamir/social_media_os/src/lib/auth/stateGenerator.ts"],"sourcesContent":["/**\r\n * CSRF State Generator using cryptographically secure random\r\n * Supports PKCE (Proof Key for Code Exchange)\r\n */\r\n\r\nimport crypto from 'crypto'\r\n\r\n/**\r\n * Generate a cryptographically secure random state\r\n * Used for CSRF protection in OAuth flows\r\n */\r\nexport function generateRandomState(length: number = 64): string {\r\n  return crypto.randomBytes(length).toString('hex')\r\n}\r\n\r\n/**\r\n * Generate PKCE parameters\r\n * code_verifier: Random value sent back to token endpoint\r\n * code_challenge: Hash of code_verifier sent to authorization endpoint\r\n */\r\nexport function generatePKCE(): {\r\n  codeChallenge: string\r\n  codeVerifier: string\r\n} {\r\n  // Generate random code verifier (43-128 characters, unreserved characters)\r\n  const codeVerifier = crypto\r\n    .randomBytes(32)\r\n    .toString('hex')\r\n    .substring(0, 128)\r\n\r\n  // Create code challenge using S256 (SHA256)\r\n  const codeChallenge = crypto\r\n    .createHash('sha256')\r\n    .update(codeVerifier)\r\n    .digest('base64')\r\n    .replace(/\\+/g, '-')\r\n    .replace(/\\//g, '_')\r\n    .replace(/=/g, '')\r\n\r\n  return { codeChallenge, codeVerifier }\r\n}\r\n\r\n/**\r\n * Verify PKCE\r\n * Ensures code_verifier matches code_challenge\r\n */\r\nexport function verifyPKCE(codeVerifier: string, codeChallenge: string): boolean {\r\n  try {\r\n    const computed = crypto\r\n      .createHash('sha256')\r\n      .update(codeVerifier)\r\n      .digest('base64')\r\n      .replace(/\\+/g, '-')\r\n      .replace(/\\//g, '_')\r\n      .replace(/=/g, '')\r\n\r\n    // Constant-time comparison to prevent timing attacks\r\n    return crypto.timingSafeEqual(Buffer.from(computed), Buffer.from(codeChallenge))\r\n  } catch (error) {\r\n    console.error('PKCE verification error:', error)\r\n    return false\r\n  }\r\n}\r\n\r\n/**\r\n * Generate a random string suitable for cryptographic operations\r\n */\r\nexport function generateRandomString(length: number = 32): string {\r\n  return crypto.randomBytes(length).toString('hex')\r\n}\r\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;;;;;;;AAED;;AAMO,SAAS,oBAAoB,SAAiB,EAAE;IACrD,OAAO,gHAAM,CAAC,WAAW,CAAC,QAAQ,QAAQ,CAAC;AAC7C;AAOO,SAAS;IAId,2EAA2E;IAC3E,MAAM,eAAe,gHAAM,CACxB,WAAW,CAAC,IACZ,QAAQ,CAAC,OACT,SAAS,CAAC,GAAG;IAEhB,4CAA4C;IAC5C,MAAM,gBAAgB,gHAAM,CACzB,UAAU,CAAC,UACX,MAAM,CAAC,cACP,MAAM,CAAC,UACP,OAAO,CAAC,OAAO,KACf,OAAO,CAAC,OAAO,KACf,OAAO,CAAC,MAAM;IAEjB,OAAO;QAAE;QAAe;IAAa;AACvC;AAMO,SAAS,WAAW,YAAoB,EAAE,aAAqB;IACpE,IAAI;QACF,MAAM,WAAW,gHAAM,CACpB,UAAU,CAAC,UACX,MAAM,CAAC,cACP,MAAM,CAAC,UACP,OAAO,CAAC,OAAO,KACf,OAAO,CAAC,OAAO,KACf,OAAO,CAAC,MAAM;QAEjB,qDAAqD;QACrD,OAAO,gHAAM,CAAC,eAAe,CAAC,OAAO,IAAI,CAAC,WAAW,OAAO,IAAI,CAAC;IACnE,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,4BAA4B;QAC1C,OAAO;IACT;AACF;AAKO,SAAS,qBAAqB,SAAiB,EAAE;IACtD,OAAO,gHAAM,CAAC,WAAW,CAAC,QAAQ,QAAQ,CAAC;AAC7C","debugId":null}},
    {"offset": {"line": 230, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/aamir/social_media_os/src/services/database/oauthStateService.ts"],"sourcesContent":["/**\r\n * OAuth State Service\r\n * Manages CSRF state tokens and PKCE verification\r\n * Database-backed for security\r\n */\r\n\r\nimport { supabase } from '@/lib/supabase'\r\nimport {\r\n  generateRandomState,\r\n  generatePKCE,\r\n  verifyPKCE,\r\n} from '@/lib/auth/stateGenerator'\r\nimport type { Platform } from '@/types'\r\n\r\nexport interface OAuthStateData {\r\n  state: string\r\n  codeVerifier?: string\r\n  codeChallenge?: string\r\n  expiresAt: Date\r\n}\r\n\r\n/**\r\n * Create OAuth state for CSRF protection and PKCE\r\n */\r\nexport async function createOAuthState(\r\n  workspaceId: string,\r\n  platform: Platform,\r\n  ipAddress?: string,\r\n  userAgent?: string,\r\n  usePKCE: boolean = true\r\n): Promise<OAuthStateData> {\r\n  try {\r\n    // Generate state\r\n    const state = generateRandomState()\r\n\r\n    let codeVerifier: string | undefined\r\n    let codeChallenge: string | undefined\r\n    let codeChallengeMethod: string | undefined\r\n\r\n    // Generate PKCE if needed\r\n    if (usePKCE) {\r\n      const pkce = generatePKCE()\r\n      codeChallenge = pkce.codeChallenge\r\n      codeVerifier = pkce.codeVerifier\r\n      codeChallengeMethod = 'S256'\r\n    }\r\n\r\n    // Calculate expiration (5 minutes)\r\n    const expiresAt = new Date(Date.now() + 5 * 60 * 1000)\r\n\r\n    // Store in database\r\n    const { error } = await (supabase.from('oauth_states') as any).insert({\r\n      workspace_id: workspaceId,\r\n      platform,\r\n      state,\r\n      code_challenge: codeChallenge || null,\r\n      code_challenge_method: codeChallengeMethod || null,\r\n      expires_at: expiresAt.toISOString(),\r\n      ip_address: ipAddress || null,\r\n      user_agent: userAgent || null,\r\n    })\r\n\r\n    if (error) throw error\r\n\r\n    return {\r\n      state,\r\n      codeVerifier,\r\n      codeChallenge,\r\n      expiresAt,\r\n    }\r\n  } catch (error) {\r\n    console.error('Error creating OAuth state:', error)\r\n    throw new Error('Failed to create OAuth state')\r\n  }\r\n}\r\n\r\n/**\r\n * Verify OAuth state (CSRF check)\r\n * Also validates PKCE if present\r\n */\r\nexport async function verifyOAuthState(\r\n  workspaceId: string,\r\n  platform: Platform,\r\n  state: string\r\n): Promise<{\r\n  valid: boolean\r\n  codeChallenge?: string\r\n  codeChallengeMethod?: string\r\n  error?: string\r\n}> {\r\n  try {\r\n    // Query database for state\r\n    const { data, error } = await (supabase\r\n      .from('oauth_states') as any)\r\n      .select('*')\r\n      .eq('workspace_id', workspaceId)\r\n      .eq('platform', platform)\r\n      .eq('state', state)\r\n      .maybeSingle()\r\n\r\n    if (error) throw error\r\n\r\n    // Check if state exists\r\n    if (!data) {\r\n      return { valid: false, error: 'State not found' }\r\n    }\r\n\r\n    // Check if already used (replay attack prevention)\r\n    if ((data as any).used) {\r\n      return { valid: false, error: 'State already used (replay attack detected)' }\r\n    }\r\n\r\n    // Check if expired\r\n    const expiresAt = new Date((data as any).expires_at).getTime()\r\n    if (Date.now() > expiresAt) {\r\n      return { valid: false, error: 'State expired' }\r\n    }\r\n\r\n    // Mark as used\r\n    const { error: updateError } = await (supabase\r\n      .from('oauth_states') as any)\r\n      .update({\r\n        used: true,\r\n        used_at: new Date().toISOString(),\r\n      })\r\n      .eq('id', (data as any).id)\r\n\r\n    if (updateError) throw updateError\r\n\r\n    return {\r\n      valid: true,\r\n      codeChallenge: (data as any).code_challenge || undefined,\r\n      codeChallengeMethod: (data as any).code_challenge_method || undefined,\r\n    }\r\n  } catch (error) {\r\n    console.error('Error verifying OAuth state:', error)\r\n    return { valid: false, error: 'State verification failed' }\r\n  }\r\n}\r\n\r\n/**\r\n * Verify PKCE\r\n */\r\nexport function verifyPKCECode(\r\n  codeVerifier: string,\r\n  codeChallenge: string\r\n): boolean {\r\n  return verifyPKCE(codeVerifier, codeChallenge)\r\n}\r\n\r\n/**\r\n * Clean up expired OAuth states\r\n * Should be run periodically as a background job\r\n */\r\nexport async function cleanupExpiredStates(): Promise<number> {\r\n  try {\r\n    const { data, error } = await supabase\r\n      .from('oauth_states')\r\n      .delete()\r\n      .lt('expires_at', new Date().toISOString())\r\n      .select('id')\r\n\r\n    if (error) throw error\r\n\r\n    const deletedCount = data?.length || 0\r\n    console.log(`Cleaned up ${deletedCount} expired OAuth states`)\r\n\r\n    return deletedCount\r\n  } catch (error) {\r\n    console.error('Error cleaning up OAuth states:', error)\r\n    return 0\r\n  }\r\n}\r\n\r\n/**\r\n * Get state info for debugging\r\n */\r\nexport async function getStateInfo(\r\n  workspaceId: string,\r\n  state: string\r\n): Promise<any | null> {\r\n  try {\r\n    const { data, error } = await supabase\r\n      .from('oauth_states')\r\n      .select('*')\r\n      .eq('workspace_id', workspaceId)\r\n      .eq('state', state)\r\n      .maybeSingle()\r\n\r\n    if (error) throw error\r\n    return data\r\n  } catch (error) {\r\n    console.error('Error getting state info:', error)\r\n    return null\r\n  }\r\n}\r\n\r\n/**\r\n * Clean up all states for a workspace (on logout or cleanup)\r\n */\r\nexport async function clearWorkspaceOAuthStates(workspaceId: string): Promise<number> {\r\n  try {\r\n    const { data, error } = await supabase\r\n      .from('oauth_states')\r\n      .delete()\r\n      .eq('workspace_id', workspaceId)\r\n      .select('id')\r\n\r\n    if (error) throw error\r\n\r\n    return data?.length || 0\r\n  } catch (error) {\r\n    console.error('Error clearing OAuth states:', error)\r\n    return 0\r\n  }\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 376, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/aamir/social_media_os/src/services/database/auditLogService.ts"],"sourcesContent":["/**\r\n * Audit Log Service\r\n * Logs all credential-related events for compliance and debugging\r\n */\r\n\r\nimport { supabase } from '@/lib/supabase'\r\nimport type { Platform } from '@/types'\r\n\r\nexport interface AuditEventParams {\r\n  workspaceId: string\r\n  userId: string\r\n  platform: Platform\r\n  action: string\r\n  status: 'success' | 'failed' | 'partial'\r\n  errorMessage?: string\r\n  errorCode?: string\r\n  ipAddress?: string\r\n  userAgent?: string\r\n  requestPath?: string\r\n  metadata?: any\r\n}\r\n\r\n/**\r\n * Log an audit event\r\n */\r\nexport async function logAuditEvent({\r\n  workspaceId,\r\n  userId,\r\n  platform,\r\n  action,\r\n  status,\r\n  errorMessage,\r\n  errorCode,\r\n  ipAddress,\r\n  userAgent,\r\n  requestPath,\r\n  metadata,\r\n}: AuditEventParams): Promise<void> {\r\n  try {\r\n    const { error } = await supabase.from('credential_audit_log').insert({\r\n      workspace_id: workspaceId,\r\n      user_id: userId,\r\n      platform,\r\n      action,\r\n      status,\r\n      error_message: errorMessage || null,\r\n      error_code: errorCode || null,\r\n      ip_address: ipAddress || null,\r\n      user_agent: userAgent || null,\r\n      request_path: requestPath || null,\r\n      metadata: metadata || null,\r\n    } as any)\r\n\r\n    if (error) {\r\n      console.error('Failed to insert audit log:', error)\r\n    }\r\n  } catch (error) {\r\n    console.error('Audit logging error:', error)\r\n    // Don't throw - logging failures shouldn't break the app\r\n  }\r\n}\r\n\r\n/**\r\n * Get audit logs for a workspace\r\n */\r\nexport async function getAuditLogs(\r\n  workspaceId: string,\r\n  filters?: {\r\n    platform?: Platform\r\n    action?: string\r\n    status?: string\r\n    limit?: number\r\n    offset?: number\r\n    startDate?: Date\r\n    endDate?: Date\r\n  }\r\n): Promise<any[]> {\r\n  try {\r\n    let query = supabase\r\n      .from('credential_audit_log')\r\n      .select('*')\r\n      .eq('workspace_id', workspaceId)\r\n      .order('created_at', { ascending: false })\r\n\r\n    if (filters?.platform) {\r\n      query = query.eq('platform', filters.platform)\r\n    }\r\n\r\n    if (filters?.action) {\r\n      query = query.eq('action', filters.action)\r\n    }\r\n\r\n    if (filters?.status) {\r\n      query = query.eq('status', filters.status)\r\n    }\r\n\r\n    if (filters?.startDate) {\r\n      query = query.gte('created_at', filters.startDate.toISOString())\r\n    }\r\n\r\n    if (filters?.endDate) {\r\n      query = query.lte('created_at', filters.endDate.toISOString())\r\n    }\r\n\r\n    const limit = Math.min(filters?.limit || 100, 1000) // Cap at 1000\r\n    const offset = filters?.offset || 0\r\n\r\n    query = query.range(offset, offset + limit - 1)\r\n\r\n    const { data, error } = await query\r\n\r\n    if (error) throw error\r\n    return data || []\r\n  } catch (error) {\r\n    console.error('Error fetching audit logs:', error)\r\n    return []\r\n  }\r\n}\r\n\r\n/**\r\n * Get audit logs for a specific user\r\n */\r\nexport async function getUserAuditLogs(\r\n  workspaceId: string,\r\n  userId: string,\r\n  options?: {\r\n    limit?: number\r\n    offset?: number\r\n  }\r\n): Promise<any[]> {\r\n  try {\r\n    let query = supabase\r\n      .from('credential_audit_log')\r\n      .select('*')\r\n      .eq('workspace_id', workspaceId)\r\n      .eq('user_id', userId)\r\n      .order('created_at', { ascending: false })\r\n\r\n    const limit = Math.min(options?.limit || 50, 500)\r\n    const offset = options?.offset || 0\r\n\r\n    query = query.range(offset, offset + limit - 1)\r\n\r\n    const { data, error } = await query\r\n\r\n    if (error) throw error\r\n    return data || []\r\n  } catch (error) {\r\n    console.error('Error fetching user audit logs:', error)\r\n    return []\r\n  }\r\n}\r\n\r\n/**\r\n * Get summary of credential activities\r\n */\r\nexport async function getAuditSummary(\r\n  workspaceId: string,\r\n  days: number = 7\r\n): Promise<{\r\n  totalConnections: number\r\n  totalDisconnections: number\r\n  totalRefreshes: number\r\n  totalFailures: number\r\n  platformStats: Record<string, any>\r\n  recentActivity: any[]\r\n}> {\r\n  try {\r\n    const startDate = new Date()\r\n    startDate.setDate(startDate.getDate() - days)\r\n\r\n    const logs = await getAuditLogs(workspaceId, {\r\n      startDate,\r\n      limit: 1000,\r\n    })\r\n\r\n    const summary = {\r\n      totalConnections: 0,\r\n      totalDisconnections: 0,\r\n      totalRefreshes: 0,\r\n      totalFailures: 0,\r\n      platformStats: {\r\n        twitter: { connections: 0, disconnections: 0, refreshes: 0, failures: 0 },\r\n        linkedin: { connections: 0, disconnections: 0, refreshes: 0, failures: 0 },\r\n        facebook: { connections: 0, disconnections: 0, refreshes: 0, failures: 0 },\r\n        instagram: { connections: 0, disconnections: 0, refreshes: 0, failures: 0 },\r\n      },\r\n      recentActivity: logs.slice(0, 10),\r\n    }\r\n\r\n    for (const log of logs) {\r\n      if (log.status === 'failed') {\r\n        summary.totalFailures++\r\n        ;(summary.platformStats as any)[(log as any).platform].failures++\r\n      }\r\n\r\n      if (log.action === 'platform_connected') {\r\n        summary.totalConnections++\r\n        ;(summary.platformStats as any)[(log as any).platform].connections++\r\n      } else if (log.action === 'platform_disconnected') {\r\n        summary.totalDisconnections++\r\n        ;(summary.platformStats as any)[(log as any).platform].disconnections++\r\n      } else if (log.action === 'token_refreshed') {\r\n        summary.totalRefreshes++\r\n        ;(summary.platformStats as any)[(log as any).platform].refreshes++\r\n      }\r\n    }\r\n\r\n    return summary\r\n  } catch (error) {\r\n    console.error('Error getting audit summary:', error)\r\n    return {\r\n      totalConnections: 0,\r\n      totalDisconnections: 0,\r\n      totalRefreshes: 0,\r\n      totalFailures: 0,\r\n      platformStats: {\r\n        twitter: { connections: 0, disconnections: 0, refreshes: 0, failures: 0 },\r\n        linkedin: { connections: 0, disconnections: 0, refreshes: 0, failures: 0 },\r\n        facebook: { connections: 0, disconnections: 0, refreshes: 0, failures: 0 },\r\n        instagram: { connections: 0, disconnections: 0, refreshes: 0, failures: 0 },\r\n      },\r\n      recentActivity: [],\r\n    }\r\n  }\r\n}\r\n\r\n/**\r\n * Clean up old audit logs (older than 90 days)\r\n */\r\nexport async function cleanupOldAuditLogs(): Promise<number> {\r\n  try {\r\n    const ninetyDaysAgo = new Date()\r\n    ninetyDaysAgo.setDate(ninetyDaysAgo.getDate() - 90)\r\n\r\n    const { data, error } = await supabase\r\n      .from('credential_audit_log')\r\n      .delete()\r\n      .lt('created_at', ninetyDaysAgo.toISOString())\r\n      .select('id')\r\n\r\n    if (error) throw error\r\n\r\n    return data?.length || 0\r\n  } catch (error) {\r\n    console.error('Error cleaning up audit logs:', error)\r\n    return 0\r\n  }\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 575, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/aamir/social_media_os/src/app/api/auth/oauth/%5Bplatform%5D/route.ts"],"sourcesContent":["/**\r\n * OAuth Initiation Route\r\n * POST /api/auth/oauth/[platform]\r\n *\r\n * Initiates OAuth flow for any supported platform\r\n * Generates CSRF state and PKCE parameters\r\n */\r\n\r\nimport { NextRequest, NextResponse } from 'next/server'\r\nimport { createServerClient } from '@/lib/supabase/server'\r\nimport { createOAuthState } from '@/services/database/oauthStateService'\r\nimport { logAuditEvent } from '@/services/database/auditLogService'\r\nimport type { Platform } from '@/types'\r\n\r\nconst OAUTH_URLS: Record<string, string> = {\r\n  twitter: 'https://twitter.com/i/oauth2/authorize',\r\n  linkedin: 'https://www.linkedin.com/oauth/v2/authorization',\r\n  facebook: 'https://www.facebook.com/v18.0/dialog/oauth',\r\n  instagram: 'https://www.instagram.com/oauth/authorize',\r\n}\r\n\r\nconst SCOPES: Record<string, string[]> = {\r\n  twitter: ['tweet.write', 'tweet.read', 'users.read'],\r\n  linkedin: ['r_basicprofile', 'w_member_social', 'r_emailaddress'],\r\n  facebook: ['pages_manage_posts', 'pages_read_engagement', 'pages_manage_metadata'],\r\n  instagram: ['instagram_graph_user_profile', 'pages_manage_posts', 'pages_read_engagement'],\r\n}\r\n\r\nexport async function POST(\r\n  req: NextRequest,\r\n  { params }: { params: Promise<{ platform: string }> }\r\n) {\r\n  const { platform: platformParam } = await params\r\n  const platform = platformParam as Platform\r\n  const ipAddress = req.headers.get('x-forwarded-for') || req.headers.get('x-real-ip')\r\n  const userAgent = req.headers.get('user-agent')\r\n\r\n  try {\r\n    // ✅ Step 1: Authenticate user\r\n    const supabase = await createServerClient()\r\n    const { data: { user } } = await supabase.auth.getUser()\r\n\r\n    if (!user) {\r\n      return NextResponse.json(\r\n        { error: 'Unauthorized', code: 'NOT_AUTHENTICATED' },\r\n        { status: 401 }\r\n      )\r\n    }\r\n\r\n    // ✅ Step 2: Get workspace\r\n    const { data: userRow, error: userError } = await supabase\r\n      .from('users')\r\n      .select('workspace_id')\r\n      .eq('id', user.id)\r\n      .maybeSingle()\r\n\r\n    if (userError || !userRow) {\r\n      return NextResponse.json(\r\n        { error: 'Workspace not found', code: 'NO_WORKSPACE' },\r\n        { status: 400 }\r\n      )\r\n    }\r\n\r\n    const workspaceId = (userRow as any).workspace_id\r\n\r\n    // ✅ Step 3: Validate platform\r\n    if (!Object.keys(OAUTH_URLS).includes(platform)) {\r\n      await logAuditEvent({\r\n        workspaceId,\r\n        userId: user.id,\r\n        platform,\r\n        action: 'oauth_initiation_invalid_platform',\r\n        status: 'failed',\r\n        errorCode: 'INVALID_PLATFORM',\r\n        ipAddress: ipAddress || undefined,\r\n      })\r\n\r\n      return NextResponse.json(\r\n        { error: 'Invalid platform', code: 'INVALID_PLATFORM' },\r\n        { status: 400 }\r\n      )\r\n    }\r\n\r\n    // ✅ Step 4: Get platform configuration\r\n    const clientId = process.env[`${platform.toUpperCase()}_CLIENT_ID`]\r\n    const baseUrl = process.env.NEXT_PUBLIC_APP_URL?.replace(/\\/$/, '')\r\n    const callbackUrl = `${baseUrl}/api/auth/oauth/${platform}/callback`\r\n\r\n    if (!clientId) {\r\n      await logAuditEvent({\r\n        workspaceId,\r\n        userId: user.id,\r\n        platform,\r\n        action: 'oauth_initiation_config_missing',\r\n        status: 'failed',\r\n        errorCode: 'CONFIG_MISSING',\r\n        ipAddress: ipAddress || undefined,\r\n      })\r\n\r\n      return NextResponse.json(\r\n        { error: `${platform} is not configured`, code: 'CONFIG_MISSING' },\r\n        { status: 500 }\r\n      )\r\n    }\r\n\r\n    // ✅ Step 5: Create OAuth state (CSRF protection)\r\n    const oauthState = await createOAuthState(\r\n      workspaceId,\r\n      platform,\r\n      ipAddress || undefined,\r\n      userAgent || undefined,\r\n      true // Use PKCE for all platforms\r\n    )\r\n\r\n    // ✅ Step 6: Build OAuth authorization URL\r\n    const params = new URLSearchParams({\r\n      client_id: clientId,\r\n      redirect_uri: callbackUrl,\r\n      response_type: 'code',\r\n      state: oauthState.state,\r\n    })\r\n\r\n    // Add platform-specific parameters\r\n    if (platform === 'twitter') {\r\n      params.append('code_challenge', oauthState.codeChallenge!)\r\n      params.append('code_challenge_method', 'S256')\r\n      params.append('scope', SCOPES[platform].join(' '))\r\n    } else if (platform === 'linkedin') {\r\n      params.append('scope', SCOPES[platform].join('%20'))\r\n    } else if (platform === 'facebook' || platform === 'instagram') {\r\n      params.append('scope', SCOPES[platform].join(','))\r\n      params.append('display', 'popup')\r\n    }\r\n\r\n    const oauthUrl = `${OAUTH_URLS[platform]}?${params.toString()}`\r\n\r\n    // ✅ Step 7: Store PKCE verifier in secure httpOnly cookie\r\n    const response = NextResponse.json({\r\n      success: true,\r\n      redirectUrl: oauthUrl,\r\n    })\r\n\r\n    if (oauthState.codeVerifier) {\r\n      response.cookies.set(\r\n        `oauth_${platform}_verifier`,\r\n        oauthState.codeVerifier,\r\n        {\r\n          httpOnly: true,\r\n          secure: process.env.NODE_ENV === 'production',\r\n          sameSite: 'lax',\r\n          maxAge: 10 * 60, // 10 minutes\r\n          path: '/',\r\n        }\r\n      )\r\n    }\r\n\r\n    // ✅ Step 8: Log success\r\n    await logAuditEvent({\r\n      workspaceId,\r\n      userId: user.id,\r\n      platform,\r\n      action: 'oauth_initiation_successful',\r\n      status: 'success',\r\n      ipAddress: ipAddress || undefined,\r\n    })\r\n\r\n    return response\r\n  } catch (error) {\r\n    console.error(`OAuth initiation error for ${platform}:`, error)\r\n\r\n    // Attempt to log error\r\n    try {\r\n      const supabase = await createServerClient()\r\n      const { data: { user } } = await supabase.auth.getUser()\r\n\r\n      if (user) {\r\n        const { data: userRow } = await supabase\r\n          .from('users')\r\n          .select('workspace_id')\r\n          .eq('id', user.id)\r\n          .maybeSingle()\r\n\r\n        if (userRow) {\r\n          await logAuditEvent({\r\n            workspaceId: (userRow as any).workspace_id,\r\n            userId: user.id,\r\n            platform,\r\n            action: 'oauth_initiation_error',\r\n            status: 'failed',\r\n            errorMessage: error instanceof Error ? error.message : String(error),\r\n            errorCode: 'INITIATION_ERROR',\r\n            ipAddress: req.headers.get('x-forwarded-for') || undefined,\r\n          })\r\n        }\r\n      }\r\n    } catch (auditError) {\r\n      console.error('Failed to log OAuth error:', auditError)\r\n    }\r\n\r\n    return NextResponse.json(\r\n      { error: 'Failed to initiate OAuth', code: 'INITIATION_ERROR' },\r\n      { status: 500 }\r\n    )\r\n  }\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}