{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 82, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/aamir/social_media_os/src/lib/supabase/server.ts"],"sourcesContent":["/**\r\n * Supabase Server Client\r\n * Use this client in server components, API routes, and server actions\r\n */\r\n\r\nimport { createServerClient, type CookieOptions } from '@supabase/ssr'\r\nimport { cookies } from 'next/headers'\r\nimport type { Database } from './types'\r\n\r\nexport async function createClient() {\n  const cookieStore = await cookies()\n\r\n  return createServerClient<Database>(\r\n    process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n    process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY!,\r\n    {\r\n      cookies: {\r\n        get(name: string) {\r\n          return cookieStore.get(name)?.value\r\n        },\r\n        set(name: string, value: string, options: CookieOptions) {\r\n          try {\r\n            cookieStore.set({ name, value, ...options })\r\n          } catch (error) {\r\n            // Handle cookie errors (happens in Server Components)\r\n          }\r\n        },\r\n        remove(name: string, options: CookieOptions) {\r\n          try {\r\n            cookieStore.set({ name, value: '', ...options })\r\n          } catch (error) {\r\n            // Handle cookie errors\r\n          }\r\n        },\r\n      },\r\n    }\r\n  )\n}\n\n// Alias to match existing imports in API routes\nexport { createClient as createServerClient }\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;;;AAED;AAAA;AACA;;;AAGO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,4IAAO;IAEjC,OAAO,IAAA,iMAAkB,sUAGvB;QACE,SAAS;YACP,KAAI,IAAY;gBACd,OAAO,YAAY,GAAG,CAAC,OAAO;YAChC;YACA,KAAI,IAAY,EAAE,KAAa,EAAE,OAAsB;gBACrD,IAAI;oBACF,YAAY,GAAG,CAAC;wBAAE;wBAAM;wBAAO,GAAG,OAAO;oBAAC;gBAC5C,EAAE,OAAO,OAAO;gBACd,sDAAsD;gBACxD;YACF;YACA,QAAO,IAAY,EAAE,OAAsB;gBACzC,IAAI;oBACF,YAAY,GAAG,CAAC;wBAAE;wBAAM,OAAO;wBAAI,GAAG,OAAO;oBAAC;gBAChD,EAAE,OAAO,OAAO;gBACd,uBAAuB;gBACzB;YACF;QACF;IACF;AAEJ","debugId":null}},
    {"offset": {"line": 133, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/aamir/social_media_os/src/lib/facebook/client.ts"],"sourcesContent":["/**\r\n * Facebook API Client Utility\r\n * Handles Facebook Graph API OAuth 2.0 and content publishing\r\n */\r\n\r\n/**\r\n * Facebook OAuth 2.0 URLs\r\n */\r\n// Use versioned OAuth endpoints to align with latest login experience\r\nexport const FACEBOOK_OAUTH_URL = 'https://www.facebook.com/v21.0/dialog/oauth';\r\nexport const FACEBOOK_TOKEN_URL = 'https://graph.facebook.com/v21.0/oauth/access_token';\r\nexport const FACEBOOK_GRAPH_BASE = 'https://graph.facebook.com/v21.0';\r\n\r\n/**\r\n * Required OAuth scopes for Facebook Pages\r\n */\r\nexport const FACEBOOK_SCOPES = [\r\n  'pages_show_list',\r\n  'pages_read_engagement',\r\n  'pages_manage_posts',\r\n  'pages_manage_engagement',\r\n  'public_profile',\r\n  'email',\r\n];\r\n\r\n/**\r\n * Generate Facebook OAuth authorization URL\r\n */\r\nexport function generateFacebookAuthUrl(\r\n  appId: string,\r\n  redirectUri: string,\r\n  state: string\r\n): string {\r\n  const params = new URLSearchParams({\r\n    client_id: appId,\r\n    redirect_uri: redirectUri,\r\n    state: state,\r\n    scope: FACEBOOK_SCOPES.join(','),\r\n    response_type: 'code',\r\n    auth_type: 'rerequest',\r\n    // Use popup display to avoid cookie consent page issues\r\n    display: 'popup',\r\n  });\r\n\r\n  return `${FACEBOOK_OAUTH_URL}?${params.toString()}`;\r\n}\r\n\r\n/**\r\n * Exchange authorization code for access token\r\n */\r\nexport async function exchangeCodeForToken(\r\n  code: string,\r\n  appId: string,\r\n  appSecret: string,\r\n  redirectUri: string\r\n): Promise<{\r\n  access_token: string;\r\n  token_type: string;\r\n  expires_in?: number;\r\n}> {\r\n  const params = new URLSearchParams({\r\n    client_id: appId,\r\n    client_secret: appSecret,\r\n    code: code,\r\n    redirect_uri: redirectUri,\r\n  });\r\n\r\n  const response = await fetch(`${FACEBOOK_TOKEN_URL}?${params.toString()}`);\r\n\r\n  if (!response.ok) {\r\n    const error = await response.json();\r\n    throw new Error(error.error?.message || 'Failed to exchange code for token');\r\n  }\r\n\r\n  return response.json();\r\n}\r\n\r\n/**\r\n * Get long-lived access token (60 days)\r\n */\r\nexport async function getLongLivedToken(\r\n  shortLivedToken: string,\r\n  appId: string,\r\n  appSecret: string\r\n): Promise<{\r\n  access_token: string;\r\n  token_type: string;\r\n  expires_in: number;\r\n}> {\r\n  const params = new URLSearchParams({\r\n    grant_type: 'fb_exchange_token',\r\n    client_id: appId,\r\n    client_secret: appSecret,\r\n    fb_exchange_token: shortLivedToken,\r\n  });\r\n\r\n  const response = await fetch(`${FACEBOOK_GRAPH_BASE}/oauth/access_token?${params.toString()}`);\r\n\r\n  if (!response.ok) {\r\n    throw new Error('Failed to get long-lived token');\r\n  }\r\n\r\n  return response.json();\r\n}\r\n\r\n/**\r\n * Get Facebook Pages managed by the user\r\n */\r\nexport async function getFacebookPages(accessToken: string): Promise<{\r\n  data: Array<{\r\n    id: string;\r\n    name: string;\r\n    access_token: string;\r\n    category: string;\r\n  }>;\r\n}> {\r\n  const response = await fetch(\r\n    `${FACEBOOK_GRAPH_BASE}/me/accounts?access_token=${accessToken}`\r\n  );\r\n\r\n  if (!response.ok) {\r\n    throw new Error('Failed to fetch Facebook pages');\r\n  }\r\n\r\n  return response.json();\r\n}\r\n\r\n/**\r\n * Get Facebook Page info\r\n */\r\nexport async function getPageInfo(\r\n  pageId: string,\r\n  pageAccessToken: string\r\n): Promise<{\r\n  id: string;\r\n  name: string;\r\n  category: string;\r\n  fan_count?: number;\r\n}> {\r\n  const response = await fetch(\r\n    `${FACEBOOK_GRAPH_BASE}/${pageId}?fields=id,name,category,fan_count&access_token=${pageAccessToken}`\r\n  );\r\n\r\n  if (!response.ok) {\r\n    throw new Error('Failed to fetch page info');\r\n  }\r\n\r\n  return response.json();\r\n}\r\n\r\n/**\r\n * Post to Facebook Page\r\n */\r\nexport async function postToFacebookPage(\r\n  pageId: string,\r\n  pageAccessToken: string,\r\n  message: string,\r\n  link?: string\r\n): Promise<{ id: string }> {\r\n  const params = new URLSearchParams({\r\n    message: message,\r\n    access_token: pageAccessToken,\r\n  });\r\n\r\n  if (link) {\r\n    params.append('link', link);\r\n  }\r\n\r\n  const response = await fetch(\r\n    `${FACEBOOK_GRAPH_BASE}/${pageId}/feed`,\r\n    {\r\n      method: 'POST',\r\n      body: params,\r\n    }\r\n  );\r\n\r\n  if (!response.ok) {\r\n    const error = await response.json();\r\n    throw new Error(error.error?.message || 'Failed to post to Facebook');\r\n  }\r\n\r\n  return response.json();\r\n}\r\n\r\n/**\r\n * Post photo to Facebook Page\r\n */\r\nexport async function postPhotoToFacebookPage(\r\n  pageId: string,\r\n  pageAccessToken: string,\r\n  imageUrl: string,\r\n  message: string\r\n): Promise<{ id: string; post_id: string }> {\r\n  const params = new URLSearchParams({\r\n    url: imageUrl,\r\n    caption: message,\r\n    access_token: pageAccessToken,\r\n  });\r\n\r\n  const response = await fetch(\r\n    `${FACEBOOK_GRAPH_BASE}/${pageId}/photos`,\r\n    {\r\n      method: 'POST',\r\n      body: params,\r\n    }\r\n  );\r\n\r\n  if (!response.ok) {\r\n    const error = await response.json();\r\n    throw new Error(error.error?.message || 'Failed to post photo to Facebook');\r\n  }\r\n\r\n  return response.json();\r\n}\r\n\r\n/**\r\n * Upload photo and get photo ID (for multi-photo posts)\r\n */\r\nexport async function uploadPhotoToFacebook(\r\n  pageId: string,\r\n  pageAccessToken: string,\r\n  imageUrl: string\r\n): Promise<{ id: string }> {\r\n  const params = new URLSearchParams({\r\n    url: imageUrl,\r\n    published: 'false', // Don't publish yet\r\n    access_token: pageAccessToken,\r\n  });\r\n\r\n  const response = await fetch(\r\n    `${FACEBOOK_GRAPH_BASE}/${pageId}/photos`,\r\n    {\r\n      method: 'POST',\r\n      body: params,\r\n    }\r\n  );\r\n\r\n  if (!response.ok) {\r\n    const error = await response.json();\r\n    throw new Error(error.error?.message || 'Failed to upload photo');\r\n  }\r\n\r\n  return response.json();\r\n}\r\n\r\n/**\r\n * Create multi-photo post\r\n */\r\nexport async function createMultiPhotoPost(\r\n  pageId: string,\r\n  pageAccessToken: string,\r\n  photoIds: string[],\r\n  message: string\r\n): Promise<{ id: string }> {\r\n  const attachedMedia = photoIds.map(id => ({ media_fbid: id }));\r\n\r\n  const params = new URLSearchParams({\r\n    message: message,\r\n    attached_media: JSON.stringify(attachedMedia),\r\n    access_token: pageAccessToken,\r\n  });\r\n\r\n  const response = await fetch(\r\n    `${FACEBOOK_GRAPH_BASE}/${pageId}/feed`,\r\n    {\r\n      method: 'POST',\r\n      body: params,\r\n    }\r\n  );\r\n\r\n  if (!response.ok) {\r\n    const error = await response.json();\r\n    throw new Error(error.error?.message || 'Failed to create multi-photo post');\r\n  }\r\n\r\n  return response.json();\r\n}\r\n\r\n/**\r\n * Get post insights (analytics)\r\n */\r\nexport async function getPostInsights(\r\n  postId: string,\r\n  pageAccessToken: string\r\n): Promise<{\r\n  data: Array<{\r\n    name: string;\r\n    values: Array<{ value: number }>;\r\n  }>;\r\n}> {\r\n  const metrics = [\r\n    'post_impressions',\r\n    'post_impressions_unique',\r\n    'post_engaged_users',\r\n    'post_clicks',\r\n    'post_reactions_like_total',\r\n    'post_reactions_love_total',\r\n  ];\r\n\r\n  const response = await fetch(\r\n    `${FACEBOOK_GRAPH_BASE}/${postId}/insights?metric=${metrics.join(',')}&access_token=${pageAccessToken}`\r\n  );\r\n\r\n  if (!response.ok) {\r\n    throw new Error('Failed to fetch post insights');\r\n  }\r\n\r\n  return response.json();\r\n}\r\n\r\n/**\r\n * Get Page insights (analytics)\r\n */\r\nexport async function getPageInsights(\r\n  pageId: string,\r\n  pageAccessToken: string,\r\n  since: string,\r\n  until: string\r\n): Promise<{\r\n  data: Array<{\r\n    name: string;\r\n    values: Array<{ value: number; end_time: string }>;\r\n  }>;\r\n}> {\r\n  const metrics = [\r\n    'page_impressions',\r\n    'page_impressions_unique',\r\n    'page_engaged_users',\r\n    'page_post_engagements',\r\n    'page_fans',\r\n  ];\r\n\r\n  const response = await fetch(\r\n    `${FACEBOOK_GRAPH_BASE}/${pageId}/insights?metric=${metrics.join(',')}&since=${since}&until=${until}&access_token=${pageAccessToken}`\r\n  );\r\n\r\n  if (!response.ok) {\r\n    throw new Error('Failed to fetch page insights');\r\n  }\r\n\r\n  return response.json();\r\n}\r\n\r\n/**\r\n * Upload video to Facebook Page\r\n */\r\nexport async function uploadVideoToFacebookPage(\r\n  pageId: string,\r\n  pageAccessToken: string,\r\n  videoUrl: string,\r\n  description: string\r\n): Promise<{ id: string }> {\r\n  const params = new URLSearchParams({\r\n    file_url: videoUrl,\r\n    description: description,\r\n    access_token: pageAccessToken,\r\n  });\r\n\r\n  const response = await fetch(\r\n    `${FACEBOOK_GRAPH_BASE}/${pageId}/videos`,\r\n    {\r\n      method: 'POST',\r\n      body: params,\r\n    }\r\n  );\r\n\r\n  if (!response.ok) {\r\n    const error = await response.json();\r\n    throw new Error(error.error?.message || 'Failed to upload video');\r\n  }\r\n\r\n  return response.json();\r\n}\r\n\r\n/**\r\n * Delete post\r\n */\r\nexport async function deletePost(\r\n  postId: string,\r\n  pageAccessToken: string\r\n): Promise<{ success: boolean }> {\r\n  const response = await fetch(\r\n    `${FACEBOOK_GRAPH_BASE}/${postId}?access_token=${pageAccessToken}`,\r\n    {\r\n      method: 'DELETE',\r\n    }\r\n  );\r\n\r\n  if (!response.ok) {\r\n    throw new Error('Failed to delete post');\r\n  }\r\n\r\n  return response.json();\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 373, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/aamir/social_media_os/src/app/api/facebook/auth/route.ts"],"sourcesContent":["/**\n * Facebook OAuth - Start Authentication Flow\n * POST /api/facebook/auth\n */\n\nimport { NextRequest, NextResponse } from 'next/server'\nimport { createServerClient } from '@/lib/supabase/server'\nimport { generateFacebookAuthUrl } from '@/lib/facebook/client'\nimport { randomBytes } from 'crypto'\n\nexport async function POST(req: NextRequest) {\n  try {\n    // Check authentication\n    const supabase = await createServerClient()\n    const {\n      data: { user },\n    } = await supabase.auth.getUser()\n\n    if (!user) {\n      return NextResponse.json({ error: 'Unauthorized' }, { status: 401 })\n    }\n\n    // Get Facebook credentials from environment\n    const appId = process.env.FACEBOOK_APP_ID\n    const appSecret = process.env.FACEBOOK_APP_SECRET\n\n    if (!appId || !appSecret) {\n      return NextResponse.json(\n        { error: 'Facebook API credentials not configured in environment' },\n        { status: 500 }\n      )\n    }\n\n    // Generate callback URL (ensure no double slash)\n    const baseUrl = process.env.NEXT_PUBLIC_APP_URL?.replace(/\\/$/, '') || ''\n    const callbackURL = `${baseUrl}/api/facebook/callback`\n\n    // Generate random state for CSRF protection\n    const state = randomBytes(32).toString('hex')\n\n    // Generate Facebook OAuth URL\n    const authUrl = generateFacebookAuthUrl(appId, callbackURL, state)\n\n    // Create response with auth URL\n    const response = NextResponse.json({\n      url: authUrl,\n      state: state,\n    })\n\n    // Store state in secure cookie for verification\n    response.cookies.set('facebook_oauth_state', state, {\n      httpOnly: true,\n      secure: process.env.NODE_ENV === 'production',\n      sameSite: 'lax',\n      maxAge: 600, // 10 minutes\n      path: '/',\n    })\n\n    return response\n  } catch (error) {\n    console.error('Facebook OAuth error:', error)\n    return NextResponse.json(\n      { \n        error: 'Failed to initiate Facebook authentication', \n        details: (error as Error).message \n      },\n      { status: 500 }\n    )\n  }\n}\n"],"names":[],"mappings":"AAAA;;;CAGC;;;;AAED;AACA;AACA;AACA;;;;;AAEO,eAAe,KAAK,GAAgB;IACzC,IAAI;QACF,uBAAuB;QACvB,MAAM,WAAW,MAAM,IAAA,wJAAkB;QACzC,MAAM,EACJ,MAAM,EAAE,IAAI,EAAE,EACf,GAAG,MAAM,SAAS,IAAI,CAAC,OAAO;QAE/B,IAAI,CAAC,MAAM;YACT,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAe,GAAG;gBAAE,QAAQ;YAAI;QACpE;QAEA,4CAA4C;QAC5C,MAAM,QAAQ,QAAQ,GAAG,CAAC,eAAe;QACzC,MAAM,YAAY,QAAQ,GAAG,CAAC,mBAAmB;QAEjD,IAAI,CAAC,SAAS,CAAC,WAAW;YACxB,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAyD,GAClE;gBAAE,QAAQ;YAAI;QAElB;QAEA,iDAAiD;QACjD,MAAM,UAAU,0EAAiC,QAAQ,OAAO,OAAO;QACvE,MAAM,cAAc,GAAG,QAAQ,sBAAsB,CAAC;QAEtD,4CAA4C;QAC5C,MAAM,QAAQ,IAAA,oHAAW,EAAC,IAAI,QAAQ,CAAC;QAEvC,8BAA8B;QAC9B,MAAM,UAAU,IAAA,6JAAuB,EAAC,OAAO,aAAa;QAE5D,gCAAgC;QAChC,MAAM,WAAW,gJAAY,CAAC,IAAI,CAAC;YACjC,KAAK;YACL,OAAO;QACT;QAEA,gDAAgD;QAChD,SAAS,OAAO,CAAC,GAAG,CAAC,wBAAwB,OAAO;YAClD,UAAU;YACV,QAAQ,oDAAyB;YACjC,UAAU;YACV,QAAQ;YACR,MAAM;QACR;QAEA,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,yBAAyB;QACvC,OAAO,gJAAY,CAAC,IAAI,CACtB;YACE,OAAO;YACP,SAAS,AAAC,MAAgB,OAAO;QACnC,GACA;YAAE,QAAQ;QAAI;IAElB;AACF","debugId":null}}]
}